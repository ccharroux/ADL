
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>MKA Internal Media Site</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Facebook and Twitter integration -->
    <meta property="og:title" content="" />
    <meta property="og:image" content="" />
    <meta property="og:url" content="" />
    <meta property="og:site_name" content="" />
    <meta property="og:description" content="" />
    <meta name="twitter:title" content="" />
    <meta name="twitter:image" content="" />
    <meta name="twitter:url" content="" />
    <meta name="twitter:card" content="" />
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="/favicon.ico">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,700,900' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700" rel="stylesheet">
    <!-- Animate.css -->
    <link rel="stylesheet" href="/css/animate.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="/css/icomoon.css">
    <!-- Simple Line Icons -->
    <link rel="stylesheet" href="/css/simple-line-icons.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="/css/bootstrap.css">
    <!-- Theme style  -->
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.18/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.2.2/css/responsive.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.5.2/css/buttons.dataTables.min.css" />
    <!--Chosen Dropdown-->
    <link rel="stylesheet" href="/css/chosen.min.css" />
    <!-- Modernizr JS -->
    <script src="/js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <style>
        .changeDate {
            width: 200px;
        }

        .changeValue {
            width: 500px;
        }

        .changeOwnerGroupId {
            width: 30px;
        }

        #btnHideOwnerChangeHistoryOwnerField input[type=button] {
            margin-bottom: 10px;
            width: 100px;
        }

        .parentOwner {
        }

        .numericColumn {
            text-align: right;
        }

        .productNotActive {
            background-color: #ccc;
        }

        .fullWidth {
            width: 100% !important;
        }

        #dtMRRCategories, #dtMRRCategories_RepOffices {
            min-width: 200px;
        }

        .MRRCategoryTotal {
            font-weight: bold;
        }

        #dtMRRStationReports, #dtMRRStationReports_Unassigned, #dtMRRClusterReports, #dtMRRClusterReports_Unassigned {
            min-width: 300px;
        }

        .tvbReportingStationStation {
            width: 150px;
        }

        .tvbReportingStationOwner {
            width: 200px;
        }

        .tvbReportingStationTimeSales {
            width: 100px;
        }

        .tvbReportingStationReuseTimeSales {
            width: 100px;
        }

        .tvbReportingStationRepFirms {
            width: 150px;
        }

        .tvbReportingStationEstimate {
            width: 100px;
        }

        .sectionProducts {
            padding-top: 5px;
        }

        .sectionProduct {
            border-top: solid 1px silver;
            margin-top: 20px;
            padding-top: 10px;
        }
    </style>
</head>
<body>
    <div id="fh5co-page">
        <header id="fh5co-header" role="banner">
            <div class="container">
                <div class="header-inner" id="menu"></div>
            </div>
        </header>
        <div id="fh5co-contact-section" class="contact-section">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 col-md-offset-3 text-center fh5co-heading">
                        <h2>Owner Dashboard</h2>
                    </div>
                </div>
                <div id="divQuickReport">
                    <label for="ddlQuickReport" class="search-ddl-label" style="text-align:right">Reports:&nbsp;</label>
                    <select class="search-ddl-select" onchange="getQuickReport(this.value)" style="width:207px;font-size:14px" id="ddlQuickReport"></select>
                </div>
                <div class="text-center margin-top-0">
                    <div class="row">
                        <div class="col-md-6 text-align-left">

                            <!-- Owner basic data -->
                            <div class="borderSection">
                                <div class="row">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanOwner">Owner</label>
                                    </div>
                                    <div class="col-md-5 text-align-left">
                                        <span id="spanOwner"></span>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input type="button" onclick="getOwnerChangeHistoryOwnerField('OwnerName', 'Owner Name');" value="History" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanAbbreviation">Abbreviation</label>
                                    </div>
                                    <div class="col-md-5 text-align-left">
                                        <span id="spanAbbreviation"></span>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input type="button" onclick="getOwnerChangeHistoryOwnerField('Abbreviation', 'Abbreviation');" value="History" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanMediaType">Media Type</label>
                                    </div>
                                    <div class="col-md-5 text-align-left">
                                        <span id="spanMediaType"></span>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input type="button" onclick="getOwnerChangeHistoryOwnerField('MediaType', 'Media Type');" value="History" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanAddress">Address</label>
                                    </div>
                                    <div class="col-md-5 text-align-left">
                                        <span id="spanAddress"></span>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input type="button" onclick="getOwnerChangeHistoryOwnerField('Address', 'Address');" value="History" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanPhone">Phone</label>
                                    </div>
                                    <div class="col-md-5 text-align-left">
                                        <span id="spanPhone"></span>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input type="button" onclick="getOwnerChangeHistoryOwnerField('Phone', 'Phone');" value="History" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanFax">Fax</label>
                                    </div>
                                    <div class="col-md-5 text-align-left">
                                        <span id="spanFax"></span>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input type="button" onclick="getOwnerChangeHistoryOwnerField('Fax', 'Fax');" value="History" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanEmail">Email</label>
                                    </div>
                                    <div class="col-md-5 text-align-left">
                                        <span id="spanEmail"></span>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input type="button" onclick="getOwnerChangeHistoryOwnerField('Email', 'Email');" value="History" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanClientID">Client ID</label>
                                    </div>
                                    <div class="col-md-5 text-align-left">
                                        <span id="spanClientID"></span>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input type="button" onclick="getOwnerChangeHistoryOwnerField('ClientID', 'Client ID');" value="History" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanClientID">SAML Status</label>
                                    </div>
                                    <div class="col-md-5 text-align-left">
                                        <span id="spanSAMLStatus"></span>
                                    </div>
                                    <!-- no change history for this table -->
                                </div>
                            </div>

                            <div class="row noMarginsLeftRight initiallyHidden borderSection" id="divOwnerChangeHistoryOwnerField">
                                <!-- dataTable-top-margin makes it too wide -->
                                <h4 class="text-center sectionHeader">History</h4>
                                <div class="col-md-9 subHeaderStyle">
                                    <div id="headerOwnerChangeHistoryOwnerField"></div>
                                </div>
                                <div class="col-md-3 text-align-center subHeaderStyle">
                                    <input style="margin-left: 30px;" value="Hide" onclick="hideOwnerChangeHistoryOwnerField();" type="button">
                                </div>
                                <table id="dtOwnerChangeHistoryOwnerField" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                    <thead>
                                        <tr>
                                            <th class="exportColumn changeDate">Change Date</th>
                                            <th class="exportColumn changeValue">Change Value</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>

                            <!-- Owner group list with market/station counts -->
                            <div class="borderSection">
                                <h4 class="text-center sectionHeader">Owner Groups</h4>
                                <div class="row">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtOwnerGroupList" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Group</th>
                                                    <th class="exportColumn numericColumn">Markets</th>
                                                    <th class="exportColumn numericColumn">Stations</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                                <!-- history (groups) -->
                                <div class="margin-top-10">
                                    <div class="row noMarginsLeftRight">
                                        <div class="col-md-9 subHeaderStyle">
                                            Owner Groups - History
                                        </div>
                                        <div class="col-md-3 text-align-center subHeaderStyle">
                                            <input style="margin-left: 30px;" id="btnShowOrHideOwnerChangeHistoryOwnerGroups" value="Show" onclick="showOrHideOwnerChangeHistoryOwnerGroups();" class="history-button" type="button">
                                        </div>
                                    </div>
                                </div>
                                <div class="row initiallyHidden" id="divOwnerChangeHistoryOwnerGroups">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtOwnerChangeHistoryOwnerGroups" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Change Date</th>
                                                    <th class="exportColumn">Group</th>
                                                    <th class="exportColumn">Change Value</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                                <!-- history (group stations) -->
                                <div class="margin-top-10">
                                    <div class="row noMarginsLeftRight">
                                        <div class="col-md-9 subHeaderStyle">
                                            Owner Group Stations - History
                                        </div>
                                        <div class="col-md-3 text-align-center subHeaderStyle">
                                            <input style="margin-left: 30px;" id="btnShowOrHideOwnerChangeHistoryOwnerGroupStations" value="Show" onclick="showOrHideOwnerChangeHistoryOwnerGroupStations();" class="history-button" type="button">
                                        </div>
                                    </div>
                                </div>
                                <div class="row initiallyHidden" id="divOwnerChangeHistoryOwnerGroupStations">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtOwnerChangeHistoryOwnerGroupStations" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Change Date</th>
                                                    <th class="exportColumn">Group</th>
                                                    <th class="exportColumn">Market</th>
                                                    <th class="exportColumn">Station</th>
                                                    <th class="exportColumn">Action</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                            </div>

                            <!-- Subsidiary owners -->
                            <div class="borderSection">
                                <h4 class="text-center sectionHeader">Subsidiary Owners</h4>
                                <div class="row">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtSubsidiaryOwnerList" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Main Owner</th>
                                                    <th class="exportColumn">Subsidiary Owner</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div class="sectionProducts">
                                <div class="row initiallyHidden productMRR sectionProduct">
                                    <div class="col-md-9">
                                        <h3 class="initiallyHidden productMRR">MRR</h3>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input id="btnShowHideMRR" type="button" onclick="showOrHideProduct('MRR');" value="Show" class="initiallyHidden productMRR" />
                                    </div>
                                </div>
                                <div id="divMRR" class="initiallyHidden productMRR">
                                    <div class="borderSection">
                                        <h4 class="text-center sectionHeader">Market Exceptions</h4>
                                        <div class="row margin-top-10" id="divMRRMarketExceptions">
                                            <!-- dataTable-top-margin makes it too wide -->
                                            <div id="divMRRMarketExceptions" class="col-md-12 text-align-left">
                                                <table id="dtOwnerMRRMarketExceptionList" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                                    <thead>
                                                        <tr>
                                                            <th class="exportColumn">Market</th>
                                                            <th class="exportColumn">Primary</th>
                                                            <th class="exportColumn">Treat as Primary</th>
                                                        </tr>
                                                    </thead>
                                                </table>
                                                <div id="divMRRCategories_Main_Empty" class="margin-top-10">No exceptions</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            
                                <div class="row initiallyHidden productXRY sectionProduct">
                                    <div class="col-md-9">
                                        <h3 class="initiallyHidden productXRY">XRY</h3>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input id="btnShowHideXRY" type="button" onclick="showOrHideProduct('XRY');" value="Show" class="initiallyHidden productXRY" />
                                    </div>
                                </div>
                                <div id="divXRY" class="initiallyHidden productXRY">
                                    <div class="borderSection">
                                        <h4 class="text-center sectionHeader">Market Exceptions</h4>
                                        <div class="row margin-top-10" id="divXRYMarketExceptions">
                                            <!-- dataTable-top-margin makes it too wide -->
                                            <div id="divXRYMarketExceptions" class="col-md-12 text-align-left">
                                                <table id="dtOwnerXRYMarketExceptionList" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                                    <thead>
                                                        <tr>
                                                            <th class="exportColumn">Market</th>
                                                            <th class="exportColumn">Primary</th>
                                                            <th class="exportColumn">Treat as Primary</th>
                                                        </tr>
                                                    </thead>
                                                </table>
                                                <div id="divXRYCategories_Main_Empty" class="margin-top-10">No exceptions</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row initiallyHidden productTVB sectionProduct">
                                    <div class="col-md-9">
                                        <h3 class="initiallyHidden productTVB">TVB</h3>
                                    </div>
                                    <div class="col-md-3 text-align-center">
                                        <input id="btnShowHideTVB" type="button" onclick="showOrHideProduct('TVB');" value="Show" class="initiallyHidden productTVB" />
                                    </div>
                                </div>
                                <div id="divTVB" class="initiallyHidden productTVB">
                                    <div class="borderSection">
                                        <h4 class="text-center sectionHeader">TVB Options</h4>
                                        <div class="row margin-top-10">
                                            <div class="col-md-4 text-align-left">
                                                <label for="spanTVBRepBillingStatus">Rep Billing Status</label>
                                            </div>
                                            <div class="col-md-5 text-align-left">
                                                <span id="spanTVBRepBillingStatus"></span>
                                            </div>
                                            <!-- no change history for this table -->
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>
                        <div class="col-md-6 text-align-left">

                            <!-- Parent owner data -->
                            <div class="borderSection">
                                <h4 class="text-center sectionHeader">Parent Owner</h4>
                                <div class="row parentOwner">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanParentOwner">Parent Owner</label>
                                    </div>
                                    <div class="col-md-8 text-align-left">
                                        <span id="spanParentOwner"></span>
                                    </div>
                                </div>
                                <div class="row parentOwner">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanParentAddress">Address</label>
                                    </div>
                                    <div class="col-md-8 text-align-left">
                                        <span id="spanParentAddress"></span>
                                    </div>
                                </div>
                                <div class="row parentOwner">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanParentPhone">Phone</label>
                                    </div>
                                    <div class="col-md-8 text-align-left">
                                        <span id="spanParentPhone"></span>
                                    </div>
                                </div>
                                <div class="row parentOwner">
                                    <div class="col-md-4 text-align-left">
                                        <label for="spanParentFax">Fax</label>
                                    </div>
                                    <div class="col-md-8 text-align-left">
                                        <span id="spanParentFax"></span>
                                    </div>
                                </div>
                            </div>
                            <hr />

                            <!-- Owner product list with market/station product counts -->
                            <div class="borderSection">
                                <h4 class="text-center sectionHeader">Owner Products</h4>
                                <div class="row">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtOwnerProductList" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Product</th>
                                                    <th class="exportColumn">Status</th>
                                                    <th class="exportColumn numericColumn">Markets</th>
                                                    <th class="exportColumn numericColumn">Primary</th>
                                                    <th class="exportColumn numericColumn">Secondary</th>
                                                    <th class="exportColumn numericColumn">Stations</th>
                                                    <th class="exportColumn numericColumn">Hold Markets</th>
                                                    <th class="exportColumn numericColumn">Hold Stations</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                                <!-- history -->
                                <div class="margin-top-10">
                                    <div class="row noMarginsLeftRight">
                                        <div class="col-md-9 subHeaderStyle">
                                            Owner Products - History
                                        </div>
                                        <div class="col-md-3 text-align-center subHeaderStyle">
                                            <input style="margin-left: 30px;" id="btnShowOrHideOwnerChangeHistoryOwnerProducts" value="Show" onclick="showOrHideOwnerChangeHistoryOwnerProducts();" class="history-button" type="button">
                                        </div>
                                    </div>
                                </div>
                                <div class="row initiallyHidden" id="divOwnerChangeHistoryOwnerProducts">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtOwnerChangeHistoryOwnerProducts" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Change Date</th>
                                                    <th class="exportColumn">Product</th>
                                                    <th class="exportColumn">Change Value</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                            </div>

                            <!-- Owner Stations -->
                            <div class="borderSection">

                                <h4 class="text-center sectionHeader">Owner Stations</h4>
                                <!-- Station list with owners and active products -->
                                <div class="row margin-top-10" id="divStationProductList">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtStationProductList" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Market</th>
                                                    <th class="exportColumn">Station</th>
                                                    <th class="exportColumn initiallyHidden text-align-center stationProductMRR">MRR</th>
                                                    <th class="exportColumn initiallyHidden text-align-center stationProductXRY">XRY</th>
                                                    <th class="exportColumn initiallyHidden text-align-center stationProductTVB">TVB</th>
                                                    <th class="exportColumn initiallyHidden text-align-center stationProductMSS">MSS</th>
                                                    <th class="exportColumn initiallyHidden text-align-center stationProductDMA">DMA</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                                <!-- history -->
                                <div class="margin-top-10">
                                    <div class="row noMarginsLeftRight">
                                        <div class="col-md-9 subHeaderStyle">
                                            Owner Stations - History
                                        </div>
                                        <div class="col-md-3 text-align-center subHeaderStyle">
                                            <input style="margin-left: 30px;" id="btnShowOrHideOwnerChangeHistoryOwnerStations" value="Show" onclick="showOrHideOwnerChangeHistoryOwnerStations();" class="history-button" type="button">
                                        </div>
                                    </div>
                                </div>
                                <div class="row initiallyHidden" id="divOwnerChangeHistoryOwnerStations">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtOwnerChangeHistoryOwnerStations" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Change Date</th>
                                                    <th class="exportColumn">Market</th>
                                                    <th class="exportColumn">Station</th>
                                                    <th class="exportColumn text-align-center">Action</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                            </div>

                            <!-- Owner personnel -->
                            <div class="borderSection">
                                <h4 class="text-center sectionHeader">Owner Personnel</h4>
                                <div class="row">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtOwnerPersonnel" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Name</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                                <!-- history -->
                                <div class="margin-top-10">
                                    <div class="row noMarginsLeftRight">
                                        <div class="col-md-9 subHeaderStyle">
                                            Owner Personnel - History
                                        </div>
                                        <div class="col-md-3 text-align-center subHeaderStyle">
                                            <input style="margin-left: 30px;" id="btnShowOrHideOwnerChangeHistoryOwnerPersonnel" value="Show" onclick="showOrHideOwnerChangeHistoryOwnerPersonnel();" class="history-button" type="button">
                                        </div>
                                    </div>
                                </div>
                                <div class="row initiallyHidden" id="divOwnerChangeHistoryOwnerPersonnel">
                                    <!-- dataTable-top-margin makes it too wide -->
                                    <div class="col-md-12 text-align-left">
                                        <table id="dtOwnerChangeHistoryOwnerPersonnel" class="dataTable-border dataTable-headers dataTable-cell-border fullWidth">
                                            <thead>
                                                <tr>
                                                    <th class="exportColumn">Change Date</th>
                                                    <th class="exportColumn">Personnel</th>
                                                    <th class="exportColumn">Change Value</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>

                            </div>

                            <!--
                                possible additions:
                                * owner groups - which products are active, similar to stations
                                * owner personnel - market name or count (once new control table implemented)
                            -->

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- jQuery -->
    <script src="/js/jquery.min.js"></script>
    <!-- jQuery Easing -->
    <script src="/js/jquery.easing.1.3.js"></script>
    <!-- Bootstrap -->
    <script src="/js/bootstrap.min.js"></script>
    <!-- Bootbox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.4.0/bootbox.min.js"></script>
    <!-- Waypoints -->
    <script src="/js/jquery.waypoints.min.js"></script>
    <!-- BlockUI JS -->
    <script src="/js/blockUI.js"></script>
    <!-- Config JS -->
    <script src="/js/config.js"></script>
    <!-- MAIN JS -->
    <script src="/js/main.js"></script>
    <!-- genericReport JS -->
    <script src="/js/genericReport.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.18/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.2/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.print.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.colVis.min.js"></script>
    <!--Chosen Dropdown-->
    <script src="/js/chosen.jquery.min.js"></script>
</body>
</html>
<script>

    var ownerId;
    var activeProductList = []; // store for later use by market/station grid

    var gotOwnerChangeHistoryOwnerGroups = false;
    var gotOwnerChangeHistoryOwnerGroupStations = false;
    var gotOwnerChangeHistoryOwnerProducts = false;
    var gotOwnerChangeHistoryOwnerStations = false;
    var gotOwnerChangeHistoryOwnerPersonnel = false;

    $(document).ready(function ()
    {
        gDataTableDefaultRows = 10;
        buildMainMenu("Owners");
        ownerId = getParameterByName("OwnerID");

        // local storage for quick reports
        if (ownerId > 0)
        {
            //setLocalStorage("quickReportQS", "ddlOwner|" + ownerId);
        }
        //else
        //{
        //    window.location = '/admin/ownership/ownershiplist.html';
        //}

        buildQuickReports(['owner']);

        setDataTable_OwnerGroupList();
        setDataTable_SubsidiaryOwners();
        setDataTable_OwnerMRRMarketExceptions();
        setDataTable_OwnerXRYMarketExceptions();
        setDataTable_OwnerProductList();
        setDataTable_StationProductList();
        setDataTable_OwnerPersonnel();

        setDataTable_OwnerChangeHistoryOwnerField();
        setDataTable_OwnerChangeHistoryOwnerGroups();
        setDataTable_OwnerChangeHistoryOwnerGroupStations();
        setDataTable_OwnerChangeHistoryOwnerProducts();
        setDataTable_OwnerChangeHistoryOwnerStations();
        setDataTable_OwnerChangeHistoryOwnerPersonnel();

        $(".initiallyHidden").hide();

        getOwner(); // success -> getParentOwner()
        getOwnerSAML();
        getSubsidiaryOwners();
        getOwnerGroups();
        getOwnerProducts(); // success -> getStationProducts()
        getOwnerPersonnel();

        cleanupBackButton();

    });

    function setDataTable_OwnerGroupList() {
        var reportTitle = "Owner Group List";
        var exportColumns = returnTableColumnsByClass("dtOwnerGroupList", "exportColumn");

        $("#dtOwnerGroupList").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                {
                    "data": 'ownerGroupName',
                    "render": function (data, type, row, meta) {
                        if (type === 'display') {
                            data = '<a href="/admin/ownershipgroup/ownershipgroup.html?OwnerGroupID=' + row["ownerGroupId"] + '">' + data + '</a>';
                        }
                        return data;
                    }
                },
                { "data": 'marketCount', "className": "numericColumn" },
                { "data": 'stationCount', "className": "numericColumn" },
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": true,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_SubsidiaryOwners() {
        var reportTitle = "Subsidiary Owners";
        var exportColumns = returnTableColumnsByClass("dtSubsidiaryOwnerList", "exportColumn");

        $("#dtSubsidiaryOwnerList").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                {
                    "data": 'mainOwnerName',
                    "render": function (data, type, row, meta) {
                        if (type === 'display' && row["mainOwnerId"] != ownerId) {
                            data = '<a href="/admin/ownership/ownershipview.html?OwnerID=' + row["mainOwnerId"] + '">' + data + '</a>';
                        }
                        return data;
                    }
                },
                {
                    "data": 'subsidiaryOwnerName',
                    "render": function (data, type, row, meta) {
                        if (type === 'display' && row["subsidiaryOwnerId"] != ownerId) {
                            data = '<a href="/admin/ownership/ownershipview.html?OwnerID=' + row["subsidiaryOwnerId"] + '">' + data + '</a>';
                        }
                        return data;
                    }
                },
            ],
            "pagingType": "full_numbers",
            "paging": false,
            "searching": false,
            "bInfo": false,
            "ordering": false,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_OwnerMRRMarketExceptions() {
        var reportTitle = "Owner MRR Market Exceptions";
        var exportColumns = returnTableColumnsByClass("dtOwnerMRRMarketExceptionList", "exportColumn");

        $("#dtOwnerMRRMarketExceptionList").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                {
                    "data": 'marketName',
                    "render": function (data, type, row, meta) {
                        if (type === 'display') {
                            data = '<a href="/admin/market/marketview.html?MarketID=' + row["marketId"] + '">' + data + '</a>';
                        }
                        return data;
                    }
                },
                { "data": "primaryMarket" },
                { "data": "treatAsPrimaryMarket" },
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": false,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_OwnerXRYMarketExceptions() {
        var reportTitle = "Owner XRY Market Exceptions";
        var exportColumns = returnTableColumnsByClass("dtOwnerXRYMarketExceptionList", "exportColumn");

        $("#dtOwnerXRYMarketExceptionList").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                {
                    "data": 'marketName',
                    "render": function (data, type, row, meta) {
                        if (type === 'display') {
                            data = '<a href="/admin/market/marketview.html?MarketID=' + row["marketId"] + '">' + data + '</a>';
                        }
                        return data;
                    }
                },
                { "data": "primaryMarket" },
                { "data": "treatAsPrimaryMarket" },
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": false,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_OwnerProductList() {
        var reportTitle = "Owner Product List";
        var exportColumns = returnTableColumnsByClass("dtOwnerProductList", "exportColumn");

        $("#dtOwnerProductList").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                { "data": 'product' },
                {
                    mRender: function (data, type, row) {
                        // will be used later by station/product grid
                        if (activeProductList.includes(row.product) == false && (row.disableDate == null || row.disableDate == "")) {
                            activeProductList.push(row.product);
                        }
                        return (row.activeDate != null && (row.disableDate == null || row.disableDate == ""))
                            ? 'Active on ' + row.activeDate
                            : (
                                (row.disableDate != null)
                                    ? 'Disabled on ' + row.disableDate
                                    : ''
                            );
                    },
                    "orderable": false,
                    "searchable": true
                },
                { "data": 'marketCount', "className": "numericColumn" },
                { "data": 'primaryMarketCount', "className": "numericColumn" },
                { "data": 'secondaryMarketCount', "className": "numericColumn" },
                { "data": 'stationCount', "className": "numericColumn" },
                { "data": 'holdMarketCount', "className": "numericColumn" },
                { "data": 'holdStationCount', "className": "numericColumn" },
            ],
            "pagingType": "full_numbers",
            "paging": false,
            "searching": false,
            "bInfo": false,
            "ordering": false,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_StationProductList() {
        var reportTitle = "Station Product List";
        var exportColumns = returnTableColumnsByClass("dtStationProductList", "exportColumn");

        $("#dtStationProductList").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                {
                    "data": 'market',
                    "render": function (data, type, row, meta) {
                        if (type === 'display') {
                            data = '<a href="/admin/market/marketview.html?MarketID=' + row["marketId"] + '">' + data + '</a>';
                        }
                        return data;
                    }
                },
                {
                    "data": 'station',
                    "render": function (data, type, row, meta) {
                        if (type === 'display') {
                            data = '<a href="/admin/station/stationview.html?StationID=' + row["stationId"] + '">' + data + '</a>';
                        }
                        return data;
                    }
                },
                { "data": 'MRR', "className": 'initiallyHidden initiallyHiddenStationProduct text-align-center stationProductMRR' },
                { "data": 'XRY', "className": 'initiallyHidden initiallyHiddenStationProduct text-align-center stationProductXRY' },
                { "data": 'TVB', "className": 'initiallyHidden initiallyHiddenStationProduct text-align-center stationProductTVB' },
                { "data": 'MSS', "className": 'initiallyHidden initiallyHiddenStationProduct text-align-center stationProductMSS' },
                { "data": 'DMA', "className": 'initiallyHidden initiallyHiddenStationProduct text-align-center stationProductDMA' }
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": true,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    // handled earlier for entire page, don't repeat
            //    // $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
            "fnDrawCallback": function () {
                showOrHideStationProducts();
            },
        });

    }

    function setDataTable_OwnerPersonnel() {
        var reportTitle = "Owner Personnel";
        var exportColumns = returnTableColumnsByClass("dtOwnerPersonnel", "exportColumn");

        $("#dtOwnerPersonnel").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                {
                    "data": 'name',
                    "render": function (data, type, row, meta) {
                        if (type === 'display') {
                            data = '<a href="/admin/personnel/personnelview.html?PersonnelID=' + row["personnelId"] + '">' + data + '</a>';
                        }
                        return data;
                    }
                },
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": false,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_OwnerChangeHistoryOwnerField() {
        var reportTitle = "Owner Change History - Owner Field";
        var exportColumns = returnTableColumnsByClass("dtOwnerChangeHistoryOwnerField", "exportColumn");

        $("#dtOwnerChangeHistoryOwnerField").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                { "data": 'Change Date', "className": "changeDate" },
                { "data": 'Change Value', "className": "changeValue" }
            ],
            "order": [
                [0, "asc"] // Change Date
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": false,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    // handled earlier for entire page, don't repeat
            //    // $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_OwnerChangeHistoryOwnerGroups() {
        var reportTitle = "Owner Change History - Owner Groups";
        var exportColumns = returnTableColumnsByClass("dtOwnerChangeHistoryOwnerGroups", "exportColumn");

        $("#dtOwnerChangeHistoryOwnerGroups").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                { "data": 'Change Date', "className": "changeDate" },
                { "data": 'Owner Group ID', "className": "changeOwnerGroupId" },
                { "data": 'Change Value' },
            ],
            "order": [
                [0, "asc"] // Change Date
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": true,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    // handled earlier for entire page, don't repeat
            //    // $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_OwnerChangeHistoryOwnerGroupStations() {
        var reportTitle = "Owner Change History - Owner Group Stations";
        var exportColumns = returnTableColumnsByClass("dtOwnerChangeHistoryOwnerGroupStations", "exportColumn");

        $("#dtOwnerChangeHistoryOwnerGroupStations").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                { "data": 'Change Date', "className": "changeDate" },
                { "data": 'Owner Group' },
                { "data": 'Market' },
                { "data": 'Station' },
                { "data": 'Added or Removed' },
            ],
            "order": [
                [0, "asc"] // Change Date
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": true,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtOwnerList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    // handled earlier for entire page, don't repeat
            //    // $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_OwnerChangeHistoryOwnerProducts() {
        var reportTitle = "Owner Change History - Owner Products";
        var exportColumns = returnTableColumnsByClass("dtOwnerChangeHistoryOwnerProducts", "exportColumn");

        $("#dtOwnerChangeHistoryOwnerProducts").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                { "data": 'Change Date', "className": "changeDate" },
                { "data": 'Product', "className": "changeOwnerProduct" },
                { "data": 'Change Value', "className": "changeOwnerProductValue" }
            ],
            "order": [
                [0, "asc"] // Change Date
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": false,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    // handled earlier for entire page, don't repeat
            //    // $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_OwnerChangeHistoryOwnerStations() {
        var reportTitle = "Owner Change History - Owner Stations";
        var exportColumns = returnTableColumnsByClass("dtOwnerChangeHistoryOwnerStations", "exportColumn");

        $("#dtOwnerChangeHistoryOwnerStations").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                { "data": 'Change Date' },
                { "data": 'Market' },
                { "data": 'Station' },
                { "data": 'Added or Removed', "className": "text-align-center" }
            ],
            "order": [
                [0, "asc"] // Change Date
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": false,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    // handled earlier for entire page, don't repeat
            //    // $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function setDataTable_OwnerChangeHistoryOwnerPersonnel() {
        var reportTitle = "Owner Change History - Owner Personnel";
        var exportColumns = returnTableColumnsByClass("dtOwnerChangeHistoryOwnerPersonnel", "exportColumn");

        $("#dtOwnerChangeHistoryOwnerPersonnel").DataTable({
            "dom": "Blfrtip",
            "pageLength": gDataTableDefaultRows,
            "data": [],
            "columns": [
                { "data": 'Change Date' },
                { "data": 'Personnel' },
                { "data": 'Added or Removed', "className": "text-align-center" }
            ],
            "order": [
                [0, "asc"] // Change Date
            ],
            "pagingType": "full_numbers",
            "paging": true,
            "searching": true,
            "bInfo": false,
            "ordering": false,
            "buttons": [
               //{
               //    extend: 'csv',
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'excel',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'pdf',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //},
               //{
               //    extend: 'print',
               //    title: reportTitle,
               //    exportOptions: {
               //        columns: exportColumns,
               //        format: {
               //            header: function (data, columnIdx) {
               //                return returnExportColumnHeadingTitle("dtMarketList", data, columnIdx);
               //            }
               //        }
               //    }
               //}
               //,
               //this button is supposed to handle column visibility
               //however it isn't working on our site
               //'colvis'
            ],
            //initComplete: function () {
            //    // handled earlier for entire page, don't repeat
            //    // $(".dataTables_filter").append('<button type="button" class="clear-button" id="clear_search_button"><img width="29" height="29" src="/images/red-x.png" /></button>');
            //},
            createdRow: function (row, data, index) {
                //this adds the class to every row
                $(row).addClass('single-line-height');
            },
            //language: {
            //    //this changes search box label from Search: to Filter Results:
            //    search: "Filter Results:"
            //}
        });

    }

    function isNullOrEmpty(s) {
        return s == null || s.toString().trim() == "";
    }

    function isNotNullOrEmpty(s) {
        return (isNullOrEmpty(s) == false);
    }

    function getOwner() {
        var url = ServicePrefix + '/api/Owner/GetOwner';

        var settings = {
            dataType: 'json',
            type: 'post',
            contentType: 'application/json',
            data: JSON.stringify({
                "inApiToken": getLocalStorage("APIToken"),
                "inOwnerId": ownerId
            }),
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
        }
        else {

            if (data.report.rows.length == 0) {
                bootbox.alert('Owner not found.\n\r\n\r', function () {
                    goBackToDashboard();
                    return;
                });

            }

            $.each(data.report.rows, function (index) {

                var obj = data.report.rows[index];

                $("#spanOwner").html(obj["Owner Name"]);
                $("#spanAbbreviation").html(obj["Owner Abbreviation"]);
                getMediaType(obj["Media Type ID"]);
                setAddress(
                    "spanAddress",
                    obj["Address"],
                    obj["Address 2"],
                    obj["City"],
                    obj["State"],
                    obj["Zip Code"],
                    obj["Zip Code 4"]
                );
                setPhone(
                    "spanPhone",
                    obj["Area Code"],
                    obj["Phone"],
                    obj["Extension"]
                );
                setPhone(
                    "spanFax",
                    obj["Fax Area Code"],
                    obj["Fax Phone"],
                    null // database doesn't include fax extensions
                );
                $("#spanEmail").html(obj["Email Address"]);
                $("#spanClientID").html(obj["MKA Client Number"]);

                getParentOwner(obj["Parent Owner ID"]);

            });

        }

    }

    function getMediaType(mediaTypeId) {
        var url = ServicePrefix + '/api/MediaType/GetMediaType'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inMediaTypeId=' + mediaTypeId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getMediaTypeSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getMediaTypeSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
        }
        else {

            if (data.report.rows.length == 0) {
                $("#spanMediaType").text("*** NOT FOUND ***");
                return;
            }

            $.each(data.report.rows, function (index) {

                var obj = data.report.rows[index];

                $("#spanMediaType").text(obj["mediaTypeName"]);
            });

        }

    }

    function setAddress(addressBlock, address1, address2, city, state, zip, zip4) {
        var addressText = "";
        if (isNotNullOrEmpty(address1)) {
            addressText += address1 + "<br />";
        }
        if (isNotNullOrEmpty(address2)) {
            addressText += address2 + "<br />";
        }
        if (isNotNullOrEmpty(city)) {
            addressText += city + ", ";
        }
        if (isNotNullOrEmpty(state)) {
            addressText += state + " ";
        }
        if (isNotNullOrEmpty(zip)) {
            addressText += zip;
        }
        if (isNotNullOrEmpty(zip4)) {
            addressText += " " + zip4;
        }
        $("#" + addressBlock).html(addressText);
    }

    function setPhone(phoneBlock, areaCode, phone, extension) {
        var phoneText = "";
        if (isNotNullOrEmpty(areaCode)) {
            phoneText += "(" + areaCode + ") ";
        }
        if (isNotNullOrEmpty(phone)) {
            phoneText += phone.substr(0, 3) + "-" + phone.substr(3, 4);
        }
        if (isNotNullOrEmpty(extension)) {
            phoneText += " ext " + extension;
        }
        $("#" + phoneBlock).text(phoneText);
    }

    function getOwnerSAML() {
        var url = ServicePrefix + '/api/Owner/GetOwnerSAML'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerSAMLSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerSAMLSuccess(data, textStatus, jQxhr) {
        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        if (data.report.rows.length == 0) {
            bootbox.alert('Faled to get owner SAML data.');
            return;
        }

        $("#spanSAMLStatus").text(data.report.rows[0].SAMLStatus);
    }

    function getParentOwner(parentOwnerId) {
        var url = ServicePrefix + '/api/ParentOwnership/GetParentOwnership';

        var settings = {
            dataType: 'json',
            type: 'post',
            contentType: 'application/json',
            data: JSON.stringify({
                "inApiToken": getLocalStorage("APIToken"),
                "inParentOwnerId": parentOwnerId
            }),
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getParentOwnerSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getParentOwnerSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
        }
        else {

            if (data.report.rows.length == 0) {
                $("#spanParentOwner").text("*** NOT FOUND ***");
                return;
            }

            $.each(data.report.rows, function (index) {

                var obj = data.report.rows[index];

                $("#spanParentOwner").html(
                    '<a href="/admin/parentownership/parentownership.html?ParentOwnershipID=' + obj["parentOwnerId"] + '">'
                    + obj["parentOwnerName"] + '</a>');
                setAddress(
                    "spanParentAddress",
                    obj["parentOwnerAddress"],
                    obj["parentOwnerAddress2"],
                    obj["parentOwnerCity"],
                    obj["parentOwnerStateAbbreviation"],
                    obj["parentOwnerZipCode"],
                    obj["parentOwnerZip4"]
                );
                setPhone(
                    "spanParentPhone",
                    obj["parentOwnerAreaCode"],
                    obj["parentOwnerPhone"],
                    obj["parentOwnerExtension"]
                );
                setPhone(
                    "spanParentFax",
                    obj["parentOwnerFaxAreaCode"],
                    obj["parentOwnerFaxPhone"],
                    null // database doesn't include fax extensions
                );
            });

        }

    }

    function getOwnerGroups() {
        var url = ServicePrefix + '/api/Owner/GetMarketStationCountByOwnerGroup'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerGroupsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);
    }

    function getOwnerGroupsSuccess(data, textStatus, jQxhr) {
        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        populateDataTable("dtOwnerGroupList", data);
    }

    function getSubsidiaryOwners() {
        var url = ServicePrefix + '/api/Owner/GetSubsidiaryOwners'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getSubsidiaryOwnersSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);
    }

    function getSubsidiaryOwnersSuccess(data, textStatus, jQxhr) {
        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        populateDataTable("dtSubsidiaryOwnerList", data);
    }

    function getOwnerMRRMarketExceptions() {
        var url = ServicePrefix + '/api/MRRReport/GetOwnerMRRMarketExceptions'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerMRRMarketExceptionsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);
    }

    function getOwnerMRRMarketExceptionsSuccess(data, textStatus, jQxhr) {
        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        populateDataTable("dtOwnerMRRMarketExceptionList", data);
    }

    function getOwnerXRYMarketExceptions() {
        var url = ServicePrefix + '/api/XRAYReport/GetOwnerXRYMarketExceptions'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerXRYMarketExceptionsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);
    }

    function getOwnerXRYMarketExceptionsSuccess(data, textStatus, jQxhr) {
        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        populateDataTable("dtOwnerXRYMarketExceptionList", data);
    }

    function getOwnerTVBOptions() {
        var url = ServicePrefix + '/api/TVBReport/GetOwnerTVBOptions'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerTVBOptionsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);
    }

    function getOwnerTVBOptionsSuccess(data, textStatus, jQxhr) {
        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        if (data.report.rows.length == 0) {
            bootbox.alert("Failed to get TVB options");
            return;
        }

        $("#spanTVBRepBillingStatus").text(data.report.rows[0].repBillingStatus);
    }

    function getOwnerProducts() {
        var url = ServicePrefix + '/api/Owner/GetMarketStationCountByOwnerProduct'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerProductsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerProductsSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        populateDataTable("dtOwnerProductList", data);

        $.each(data.report.rows, function (index) {
            var obj = data.report.rows[index];

            if (obj["disableDate"] == null || obj["disableDate"] == "") {
                $(".product" + obj["product"]).show();
                //$("#div" + obj["product"]).hide();
                changeValueFromShowToHide("btnShowHide" + obj["product"]);

                switch (obj["product"]) {
                    case "MRR":
                        getOwnerMRRMarketExceptions();
                        break;

                    case "XRY":
                        getOwnerXRYMarketExceptions();
                        break;

                    case "TVB":
                        getOwnerTVBOptions();
                        break;
                }
            }
        });

        getStationProducts();
    }

    function getStationProducts() {
        var url = ServicePrefix + '/api/Owner/GetMarketStationListByOwnerProduct'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getStationProductsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getStationProductsSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        populateDataTable("dtStationProductList", data);

        showOrHideStationProducts();
    }

    function showOrHideStationProducts() {
        $(".initiallyHiddenStationProduct").hide();
        // activeProductList is populated as side effect of market/product grid
        activeProductList.forEach(function (e) {
            $(".stationProduct" + e).show();
        });
    }

    function getOwnerPersonnel() {
        var url = ServicePrefix + '/api/Personnel/GetPersonnelListByMarketOwner';

        var settings = {
            dataType: 'json',
            type: 'post',
            contentType: 'application/json',
            data: JSON.stringify({
                "inApiToken": getLocalStorage("APIToken"),
                "inOwnerId": ownerId
            }),
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerPersonnelSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerPersonnelSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        populateDataTable("dtOwnerPersonnel", data);
    }

    function changeValueFromHideToShow(controlId) {
        var obj = $("#" + controlId);
        if (obj != null && obj.val() != null) {
            obj.val(obj.val().replace("Hide", "Show"));
        }
    }

    function changeValueFromShowToHide(controlId) {
        var obj = $("#" + controlId);
        if (obj != null && obj.val() != null) {
            obj.val(obj.val().replace("Show", "Hide"));
        }
    }

    function showOrHideProduct(productId) {
        var divProduct = $("#div" + productId);
        if (divProduct.is(":visible")) {
            divProduct.hide();
            changeValueFromHideToShow("btnShowHide" + productId);
        } else {
            divProduct.show();
            changeValueFromShowToHide("btnShowHide" + productId);
        }
    }

    function getOwnerChangeHistoryOwnerField(ownerFieldName, ownerFieldDescription) {
        $("#headerOwnerChangeHistoryOwnerField").text(ownerFieldDescription + ' - History');

        var url = ServicePrefix + '/api/Owner/GetOwnerChangeHistoryOwnerField'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId
            + '&inOwnerFieldName=' + ownerFieldName;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerChangeHistoryOwnerFieldSuccess(data, textStatus, jQxhr, ownerFieldDescription);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerChangeHistoryOwnerFieldSuccess(data, textStatus, jQxhr, ownerFieldDescription) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        //if (data.report.rows.length == 0) {
        //    bootbox.alert(ownerFieldDescription + ": No changes found");
        //    hideOwnerChangeHistoryOwnerField();
        //    return;
        //}

        populateDataTable("dtOwnerChangeHistoryOwnerField", data);
        $("#divOwnerChangeHistoryOwnerField").show();

    }

    function hideOwnerChangeHistoryOwnerField() {
        $("#divOwnerChangeHistoryOwnerField").hide();
    }

    function showOrHideOwnerChangeHistoryOwnerGroups() {
        if ($("#divOwnerChangeHistoryOwnerGroups").is(":visible")) {
            $("#divOwnerChangeHistoryOwnerGroups").hide();
            changeValueFromHideToShow("btnShowOrHideOwnerChangeHistoryOwnerGroups");
        } else {
            if (gotOwnerChangeHistoryOwnerGroups) {
                $("#divOwnerChangeHistoryOwnerGroups").show();
            } else {
                getOwnerChangeHistoryOwnerGroups();
            }
            changeValueFromShowToHide("btnShowOrHideOwnerChangeHistoryOwnerGroups");
        }
    }

    function getOwnerChangeHistoryOwnerGroups() {
        var url = ServicePrefix + '/api/Owner/GetOwnerChangeHistoryOwnerGroups'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerChangeHistoryOwnerGroupsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerChangeHistoryOwnerGroupsSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        if (data.report.rows.length == 0) {
            bootbox.alert("No changes found");
            return;
        }

        populateDataTable("dtOwnerChangeHistoryOwnerGroups", data);
        $("#divOwnerChangeHistoryOwnerGroups").show();
        gotOwnerChangeHistoryOwnerGroups = true;

    }

    function showOrHideOwnerChangeHistoryOwnerGroupStations() {
        if ($("#divOwnerChangeHistoryOwnerGroupStations").is(":visible")) {
            $("#divOwnerChangeHistoryOwnerGroupStations").hide();
            changeValueFromHideToShow("btnShowOrHideOwnerChangeHistoryOwnerGroupStations");
        } else {
            if (gotOwnerChangeHistoryOwnerGroupStations) {
                $("#divOwnerChangeHistoryOwnerGroupStations").show();
            } else {
                getOwnerChangeHistoryOwnerGroupStations();
            }
            changeValueFromShowToHide("btnShowOrHideOwnerChangeHistoryOwnerGroupStations");
        }
    }

    function getOwnerChangeHistoryOwnerGroupStations() {
        var url = ServicePrefix + '/api/Owner/GetOwnerChangeHistoryOwnerGroupStations'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerChangeHistoryOwnerGroupStationsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerChangeHistoryOwnerGroupStationsSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        if (data.report.rows.length == 0) {
            bootbox.alert("No changes found");
            return;
        }

        populateDataTable("dtOwnerChangeHistoryOwnerGroupStations", data);
        $("#divOwnerChangeHistoryOwnerGroupStations").show();
        gotOwnerChangeHistoryOwnerGroupStations = true;

    }

    function showOrHideOwnerChangeHistoryOwnerProducts() {
        if ($("#divOwnerChangeHistoryOwnerProducts").is(":visible")) {
            $("#divOwnerChangeHistoryOwnerProducts").hide();
            changeValueFromHideToShow("btnShowOrHideOwnerChangeHistoryOwnerProducts");
        } else {
            if (gotOwnerChangeHistoryOwnerProducts) {
                $("#divOwnerChangeHistoryOwnerProducts").show();
            } else {
                getOwnerChangeHistoryOwnerProducts();
            }
            changeValueFromShowToHide("btnShowOrHideOwnerChangeHistoryOwnerProducts");
        }
    }

    function getOwnerChangeHistoryOwnerProducts() {
        var url = ServicePrefix + '/api/Owner/GetOwnerChangeHistoryOwnerProducts'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerChangeHistoryOwnerProductsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerChangeHistoryOwnerProductsSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        if (data.report.rows.length == 0) {
            bootbox.alert("No changes found");
            return;
        }

        populateDataTable("dtOwnerChangeHistoryOwnerProducts", data);
        $("#divOwnerChangeHistoryOwnerProducts").show();
        gotOwnerChangeHistoryOwnerProducts = true;

    }

    function showOrHideOwnerChangeHistoryOwnerStations() {
        if ($("#divOwnerChangeHistoryOwnerStations").is(":visible")) {
            $("#divOwnerChangeHistoryOwnerStations").hide();
            changeValueFromHideToShow("btnShowOrHideOwnerChangeHistoryOwnerStations");
        } else {
            if (gotOwnerChangeHistoryOwnerStations) {
                $("#divOwnerChangeHistoryOwnerStations").show();
            } else {
                getOwnerChangeHistoryOwnerStations();
            }
            changeValueFromShowToHide("btnShowOrHideOwnerChangeHistoryOwnerStations");
        }
    }

    function getOwnerChangeHistoryOwnerStations() {
        var url = ServicePrefix + '/api/Owner/GetOwnerChangeHistoryOwnerStations'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerChangeHistoryOwnerStationsSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerChangeHistoryOwnerStationsSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        if (data.report.rows.length == 0) {
            bootbox.alert("No changes found");
            return;
        }

        populateDataTable("dtOwnerChangeHistoryOwnerStations", data);
        $("#divOwnerChangeHistoryOwnerStations").show();
        gotOwnerChangeHistoryOwnerStations = true;

    }

    function showOrHideOwnerChangeHistoryOwnerPersonnel() {
        if ($("#divOwnerChangeHistoryOwnerPersonnel").is(":visible")) {
            $("#divOwnerChangeHistoryOwnerPersonnel").hide();
            changeValueFromHideToShow("btnShowOrHideOwnerChangeHistoryOwnerPersonnel");
        } else {
            if (gotOwnerChangeHistoryOwnerPersonnel) {
                $("#divOwnerChangeHistoryOwnerPersonnel").show();
            } else {
                getOwnerChangeHistoryOwnerPersonnel();
            }
            changeValueFromShowToHide("btnShowOrHideOwnerChangeHistoryOwnerPersonnel");
        }
    }

    function getOwnerChangeHistoryOwnerPersonnel() {
        var url = ServicePrefix + '/api/Owner/GetOwnerChangeHistoryOwnerPersonnel'
            + '?inApiToken=' + getLocalStorage("APIToken")
            + '&inOwnerId=' + ownerId;

        var settings = {
            dataType: 'json',
            type: 'get',
            contentType: 'application/json',
            processData: false,
            success: function (data, textStatus, jQxhr) {
                getOwnerChangeHistoryOwnerPersonnelSuccess(data, textStatus, jQxhr);
            },
            error: function (jQxhr, textStatus, errorThrown) {
                genericAjaxError(jQxhr, textStatus, errorThrown);
            }
        };

        $.ajax(url, settings);

    }

    function getOwnerChangeHistoryOwnerPersonnelSuccess(data, textStatus, jQxhr) {

        if (data.response.status != "SUCCESS") {
            MKAErrorMessageRtn(data.response.errorMessage[0]);
            return;
        }

        if (data.report.rows.length == 0) {
            bootbox.alert("No changes found");
            return;
        }

        populateDataTable("dtOwnerChangeHistoryOwnerPersonnel", data);
        $("#divOwnerChangeHistoryOwnerPersonnel").show();
        gotOwnerChangeHistoryOwnerPersonnel = true;

    }

    function genericAjaxError(jQxhr, textStatus, errorThrown) {
        MKAErrorMessageRtn(errorThrown);
    }
</script>
